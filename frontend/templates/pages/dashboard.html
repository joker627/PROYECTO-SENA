{% extends 'base_admin.html' %}

{% block title %}Dashboard - Sign Technology{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="page-header">
    <div class="page-header-left">
        <h1>Dashboard</h1>
        <p>Bienvenido, {{ session.user.nombre_completo if session.user else 'Administrador' }}</p>
    </div>
    <div class="page-header-right">
        <div class="datetime-badge">
            <img src="{{ url_for('static', filename='img/icons/schedule.svg') }}" alt="" width="20" height="20" class="icon">
            <span id="currentDateTime">{{ current_time.strftime('%a %d %b %H:%M') }}</span>
        </div>
        <a href="{{ url_for('dashboard') }}" class="refresh-btn" title="Actualizar datos">
            <img src="{{ url_for('static', filename='img/icons/refresh.svg') }}" alt="" width="20" height="20">
        </a>
    </div>
</div>

<!-- Error Message -->
<div class="error-message" id="errorMessage">
    <img src="{{ url_for('static', filename='img/icons/error-filled.svg') }}" alt="" width="20" height="20" class="icon">
    <span id="errorText">No se pudieron cargar las estadísticas</span>
</div>

<!-- Sección: Estadísticas -->
<div class="section-title">
    <img src="{{ url_for('static', filename='img/icons/insights.svg') }}" alt="" width="24" height="24" class="icon">
    Estadísticas del Sistema
</div>

<!-- Grid Estadísticas -->
<div class="stats-grid" id="statsGrid">
    <div class="stat-card">
        <div class="stat-icon teal">
            <img src="{{ url_for('static', filename='img/icons/translate.svg') }}" alt="" width="24" height="24">
        </div>
        <div class="stat-info">
            <h3>Traducciones</h3>
            <div class="stat-value">{{ stats.total_traducciones if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon purple">
            <img src="{{ url_for('static', filename='img/icons/volunteer.svg') }}" alt="" width="24" height="24">
        </div>
        <div class="stat-info">
            <h3>Contribuciones</h3>
            <div class="stat-value">{{ stats.total_contribuciones if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon yellow">
            <img src="{{ url_for('static', filename='img/icons/schedule.svg') }}" alt="" width="24" height="24">
        </div>
        <div class="stat-info">
            <h3>Pendientes</h3>
            <div class="stat-value">{{ stats.contribuciones_pendientes if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon green">
            <img src="{{ url_for('static', filename='img/icons/check-circle-filled.svg') }}" alt="" width="24" height="24">
        </div>
        <div class="stat-info">
            <h3>Aprobadas</h3>
            <div class="stat-value">{{ stats.contribuciones_aprobadas if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon blue">
            <img src="{{ url_for('static', filename='img/icons/sign-language.svg') }}" alt="" width="24" height="24">
        </div>
        <div class="stat-info">
            <h3>Señas Oficiales</h3>
            <div class="stat-value">{{ stats.senas_oficiales if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon red">
            <img src="{{ url_for('static', filename='img/icons/flag.svg') }}" alt="" width="24" height="24">
        </div>
        <div class="stat-info">
            <h3>Reportes Activos</h3>
            <div class="stat-value">{{ stats.reportes_activos if stats else 0 }}</div>
        </div>
    </div>
</div>

<!-- Sección: Información -->
<div class="section-title">
    <img src="{{ url_for('static', filename='img/icons/info-filled.svg') }}" alt="" width="24" height="24" class="icon">
    Información General
</div>

<!-- Tarjetas de Información -->
<div class="cards-grid">
    <div class="info-card">
        <div class="info-card-header">
            <div class="info-card-icon teal">
                <img src="{{ url_for('static', filename='img/icons/person.svg') }}" alt="" width="24" height="24">
            </div>
            <div class="info-card-title">
                <h3>Información del Usuario</h3>
                <p>Tu cuenta</p>
            </div>
        </div>
        <div class="info-item">
            <label>Correo</label>
            <span>{{ session.user.correo if session.user else '--' }}</span>
        </div>
        <div class="info-item">
            <label>Rol</label>
            <span>{{ session.user.nombre_rol if session.user else 'Usuario' }}</span>
        </div>
        <div class="info-item">
            <label>Estado</label>
            <span class="status-indicator">
                <span class="status-dot"></span>
                Activo
            </span>
        </div>
    </div>

    <div class="info-card">
        <div class="info-card-header">
            <div class="info-card-icon purple">
                <img src="{{ url_for('static', filename='img/icons/smart-toy.svg') }}" alt="" width="24" height="24">
            </div>
            <div class="info-card-title">
                <h3>Modelo IA</h3>
                <p>Estado del traductor</p>
            </div>
        </div>
        <div class="info-item">
            <label>Precisión</label>
            {% set precision = stats.precision_modelo|float if stats and stats.precision_modelo else 0 %}
            <span class="precision-badge {{ 'danger' if precision < 50 else 'warning' if precision < 75 else '' }}">
                <img src="{{ url_for('static', filename='img/icons/' + ('trending-up.svg' if precision >= 75 else 'trending-down.svg')) }}" alt="" width="14" height="14" style="vertical-align: middle;">
                {{ precision }}%
            </span>
        </div>
        <div class="info-item">
            <label>Última actualización</label>
            <span>{{ stats.fecha_actualizacion[:10] if stats and stats.fecha_actualizacion else 'Ahora'
                }}</span>
        </div>
    </div>
</div>

<!-- Sección: Acciones -->
<div class="section-title">
    <img src="{{ url_for('static', filename='img/icons/bolt.svg') }}" alt="" width="24" height="24" class="icon">
    Acciones Rápidas
</div>

<!-- Acciones Rápidas -->
<div class="quick-actions">
    <a href="{{ url_for('inicio') }}" class="action-btn primary">
        <img src="{{ url_for('static', filename='img/icons/home.svg') }}" alt="" width="20" height="20" class="icon">
        Ir al Inicio
    </a>
    <a href="http://localhost:8000/docs" target="_blank" class="action-btn secondary">
        <img src="{{ url_for('static', filename='img/icons/code.svg') }}" alt="" width="20" height="20" class="icon">
        Ver API
    </a>
    <a href="{{ url_for('contribuciones') }}" class="action-btn secondary">
        <img src="{{ url_for('static', filename='img/icons/add-circle.svg') }}" alt="" width="20" height="20" class="icon">
        Revisar Contribuciones
    </a>
</div>
{% endblock %}