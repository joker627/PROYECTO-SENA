{% extends 'base_admin.html' %}

{% block title %}Dashboard - Sign Technology{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="page-header">
    <div class="page-header-left">
        <h1>Dashboard</h1>
        <p>Bienvenido, {{ session.user.nombre_completo if session.user else 'Administrador' }}</p>
    </div>
    <div class="page-header-right">
        <div class="datetime-badge">
            <span class="material-icons">schedule</span>
            <span id="currentDateTime">--</span>
        </div>
        <button class="refresh-btn" id="refreshBtn" title="Actualizar datos">
            <span class="material-icons">refresh</span>
        </button>
    </div>
</div>

<!-- Error Message -->
<div class="error-message" id="errorMessage">
    <span class="material-icons">error</span>
    <span id="errorText">No se pudieron cargar las estadísticas</span>
</div>

<!-- Sección: Estadísticas -->
<div class="section-title">
    <span class="material-icons">insights</span>
    Estadísticas del Sistema
</div>

<!-- Grid Estadísticas -->
<div class="stats-grid" id="statsGrid">
    <div class="stat-card">
        <div class="stat-icon teal">
            <span class="material-icons">translate</span>
        </div>
        <div class="stat-info">
            <h3>Traducciones</h3>
            <div class="stat-value">{{ stats.total_traducciones if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon purple">
            <span class="material-icons">volunteer_activism</span>
        </div>
        <div class="stat-info">
            <h3>Contribuciones</h3>
            <div class="stat-value">{{ stats.total_contribuciones if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon yellow">
            <span class="material-icons">pending</span>
        </div>
        <div class="stat-info">
            <h3>Pendientes</h3>
            <div class="stat-value">{{ stats.contribuciones_pendientes if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon green">
            <span class="material-icons">check_circle</span>
        </div>
        <div class="stat-info">
            <h3>Aprobadas</h3>
            <div class="stat-value">{{ stats.contribuciones_aprobadas if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon blue">
            <span class="material-icons">sign_language</span>
        </div>
        <div class="stat-info">
            <h3>Señas Oficiales</h3>
            <div class="stat-value">{{ stats.senas_oficiales if stats else 0 }}</div>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon red">
            <span class="material-icons">report</span>
        </div>
        <div class="stat-info">
            <h3>Reportes Activos</h3>
            <div class="stat-value">{{ stats.reportes_activos if stats else 0 }}</div>
        </div>
    </div>
</div>

<!-- Sección: Información -->
<div class="section-title">
    <span class="material-icons">info</span>
    Información General
</div>

<!-- Tarjetas de Información -->
<div class="cards-grid">
    <div class="info-card">
        <div class="info-card-header">
            <div class="info-card-icon teal">
                <span class="material-icons">person</span>
            </div>
            <div class="info-card-title">
                <h3>Información del Usuario</h3>
                <p>Tu cuenta</p>
            </div>
        </div>
        <div class="info-item">
            <label>Correo</label>
            <span>{{ session.user.correo if session.user else '--' }}</span>
        </div>
        <div class="info-item">
            <label>Rol</label>
            <span>{{ session.user.nombre_rol if session.user else 'Usuario' }}</span>
        </div>
        <div class="info-item">
            <label>Estado</label>
            <span class="status-indicator">
                <span class="status-dot"></span>
                Activo
            </span>
        </div>
    </div>

    <div class="info-card">
        <div class="info-card-header">
            <div class="info-card-icon purple">
                <span class="material-icons">smart_toy</span>
            </div>
            <div class="info-card-title">
                <h3>Modelo IA</h3>
                <p>Estado del traductor</p>
            </div>
        </div>
        <div class="info-item">
            <label>Precisión</label>
            {% set precision = stats.precision_modelo|float if stats and stats.precision_modelo else 0 %}
            <span class="precision-badge {{ 'danger' if precision < 50 else 'warning' if precision < 75 else '' }}">
                <span class="material-icons" style="font-size: 14px;">{{ 'trending_up' if precision >= 75
                    else 'trending_down' }}</span>
                {{ precision }}%
            </span>
        </div>
        <div class="info-item">
            <label>Última actualización</label>
            <span>{{ stats.fecha_actualizacion[:10] if stats and stats.fecha_actualizacion else 'Ahora'
                }}</span>
        </div>
    </div>
</div>

<!-- Sección: Acciones -->
<div class="section-title">
    <span class="material-icons">bolt</span>
    Acciones Rápidas
</div>

<!-- Acciones Rápidas -->
<div class="quick-actions">
    <a href="{{ url_for('inicio') }}" class="action-btn primary">
        <span class="material-icons">home</span>
        Ir al Inicio
    </a>
    <a href="http://localhost:8000/docs" target="_blank" class="action-btn secondary">
        <span class="material-icons">api</span>
        Ver API
    </a>
    <a href="{{ url_for('contribuciones') }}" class="action-btn secondary">
        <span class="material-icons">add_circle</span>
        Revisar Contribuciones
    </a>
</div>
{% endblock %}