<link rel="stylesheet" href="{{ url_for('static', filename='css/menu.css') }}">

{% from 'components/_badge.html' import render_badge %}

<nav class="navbar">
    <div class="brand">
    <a href="{{ url_for('general_bp.index') }}" class="brand-link">
            <img src="{{ url_for('static', filename='img/general/logo.webp') }}" alt="Logo de Sign Technology"
                class="logo">
            <div class="brand-text">
                <div class="brand-name">Sign Technology</div>
                <div class="brand-tagline">INNOVACIÓN DIGITAL</div>
            </div>
        </a>
    </div>

    <div class="nav-wrapper">
        <ul class="nav-links">
            <li><a href="{{ url_for('general_bp.index') }}">Inicio</a></li>
            <li><a href="{{ url_for('general_bp.nosotros') }}">Nosotros</a></li>
            <li><a href="{{ url_for('general_bp.tutoriales') }}">Tutoriales</a></li>
        </ul>

        <div class="nav-actions">
            {% if session.get('usuario') or session.get('user_id') %}
            <!-- Sección cuando SÍ está logueado - Notificaciones y avatar clickeable -->
            <div class="user-section">
                <!-- Notificaciones deshabilitadas temporalmente -->

                <div class="user-dropdown-trigger">
                    <div class="user-avatar">
                        {% set nombre = session.get('user_name', 'Usuario') %}
                        {% set palabras = nombre.split() %}
                        {% if palabras|length > 1 %}
                        {{ (palabras[0][0] + palabras[-1][0])|upper }}
                        {% else %}
                        {{ (nombre[0] + (nombre[-1] if nombre|length > 1 else ''))|upper }}
                        {% endif %}
                    </div>
                    <span class="user-name-nav">{{ session.get('user_name', 'Usuario') }}</span>
                    <i class="fas fa-chevron-down dropdown-arrow"></i>
                </div>

                <!-- Menú desplegable usuario -->
                <div class="user-dropdown-menu">
                    <div class="dropdown-header">
                        <div class="user-avatar-large">
                            {% set nombre = session.get('user_name', 'Usuario') %}
                            {% set palabras = nombre.split() %}
                            {% if palabras|length > 1 %}
                            {{ (palabras[0][0] + palabras[-1][0])|upper }}
                            {% else %}
                            {{ (nombre[0] + (nombre[-1] if nombre|length > 1 else ''))|upper }}
                            {% endif %}
                        </div>
                        <div class="user-details">
                            <div class="user-name-dropdown">{{ session.get('user_name', 'Usuario') }}</div>
                            <div class="user-email">{{ session.get('usuario', {}).get('correo',
                                'correo@ejemplo.com') }}</div>
                        </div>
                    </div>
                    <div class="dropdown-divider"></div>
                    {% if session.get('id_rol') == 1 %}
                        <a href="{{ url_for('general_bp.admin_dashboard') }}" class="dropdown-item">
                            <i class="fas fa-cog"></i> Panel Administrador
                        </a>
                    {% elif session.get('id_rol') == 2 %}
                        <a href="/gestor/panel" class="dropdown-item">
                            <i class="fas fa-tasks"></i> Panel Gestor
                        </a>
                    {% endif %}
                    <a href="{{ url_for('auth_bp.logout') }}" class="dropdown-item logout">
                        <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                    </a>
                </div>

                <!-- Notificaciones temporalmente ocultas -->
            </div>
            {% else %}
            <!-- Sección cuando NO está logueado -->
            <div class="auth-buttons auth-section">
            <a href="{{ url_for('auth_bp.login') }}" class="admin-btn">Panel Admin</a>
            </div>
            {% endif %}
        </div>

        <button class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </div>
</nav>

<div class="mobile-menu">
    <button class="close-menu">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
    </button>

    <div class="mobile-header">
        <a href="{{ url_for('general_bp.index') }}" class="mobile-brand-link">
            <img src="{{ url_for('static', filename='img/general/logo.webp') }}" alt="Logo de Sign Technology"
                class="logo">
            <div class="mobile-brand-text">
                <div class="mobile-brand-name-top">Sign</div>
                <div class="mobile-brand-name-bottom">Technology</div>
                <div class="mobile-brand-tagline">INNOVACIÓN DIGITAL</div>
            </div>
        </a>
    </div>

    <a href="{{ url_for('general_bp.index') }}">
        <svg viewBox="0 0 26 26">
            <path d="M13 20v-7h4v7h5v-9h3L13 3 2 11h3v9z" />
        </svg>
        Inicio
    </a>
    <a href="{{ url_for('general_bp.nosotros') }}">
        <svg viewBox="0 0 26 26">
            <path
                d="M13 13c2.4 0 4.3-1.9 4.3-4.3s-1.9-4.3-4.3-4.3-4.3 1.9-4.3 4.3 1.9 4.3 4.3 4.3zm0 2.2c-2.9 0-8.7 1.5-8.7 4.4v2.2h17.4v-2.2c0-2.9-5.8-4.4-8.7-4.4z" />
        </svg>
        Nosotros
    </a>
    <a href="{{ url_for('general_bp.tutoriales') }}">
        <svg viewBox="0 0 26 26">
            <path d="M13 3l13 20H0z" />
            <path d="M13 7l8 12H5z" fill="#e8f5e9" />
        </svg>
        Tutoriales
    </a>

    {% if session.get('usuario') or session.get('user_id') %}
    <!-- Sección móvil cuando SÍ está logueado -->
    <div class="mobile-user-section">
        <div class="mobile-user-info">
            <div class="mobile-user-avatar">
                {% set nombre = session.get('user_name', 'Usuario') %}
                {% set palabras = nombre.split() %}
                {% if palabras|length > 1 %}
                {{ (palabras[0][0] + palabras[-1][0])|upper }}
                {% else %}
                {{ (nombre[0] + (nombre[-1] if nombre|length > 1 else ''))|upper }}
                {% endif %}
            </div>
            <div>
                <div class="mobile-user-name">{{ session.get('user_name', 'Usuario') }}</div>
                <div class="mobile-user-status">Conectado</div>
            </div>
        </div>

        <!-- Notificaciones móvil eliminadas -->

        <div class="mobile-panel-section">
            {% if session.get('id_rol') == 1 %}
                <a href="{{ url_for('general_bp.admin_dashboard') }}" class="mobile-panel-link">
                    <i class="fas fa-cog"></i> Panel Administrador
                </a>
            {% elif session.get('id_rol') == 2 %}
                <a href="/gestor/panel" class="mobile-panel-link">
                    <i class="fas fa-tasks"></i> Panel Gestor
                </a>
            {% endif %}
            <a href="{{ url_for('auth_bp.logout') }}" class="mobile-logout-link">
                <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
            </a>
        </div>
    </div>
    {% else %}
    <!-- Sección móvil cuando NO está logueado -->
    <div class="mobile-auth-section">
    <a href="{{ url_for('auth_bp.login') }}" class="mobile-admin-btn">
            <svg viewBox="0 0 26 26">
                <path
                    d="M20.8 14c.04-.3.07-.65.07-1 0-.35-.03-.7-.08-1l2.2-1.7c.2-.15.25-.45.13-.65l-2.1-3.6c-.12-.24-.4-.32-.64-.24l-2.6 1c-.55-.42-1.12-.76-1.75-1l-.4-2.8c-.04-.26-.26-.45-.52-.45h-4.2c-.26 0-.47.19-.51.45l-.4 2.8c-.63.26-1.2.61-1.75 1l-2.6-1c-.24-.09-.51 0-.64.24l-2.1 3.6c-.12.2-.09.51.13.65l2.2 1.7c-.05.3-.09.65-.09 1s.04.7.09 1l-2.2 1.7c-.2.15-.25.45-.13.65l2.1 3.6c.12.24.4.32.64.24l2.6-1c.55.42 1.12.76 1.75 1l.4 2.8c.04.26.26.45.52.45h4.2c.26 0 .47-.19.51-.45l.4-2.8c.63-.26 1.2-.61 1.75-1l2.6.96c.24.09.51 0 .64-.24l2.1-3.6c.12-.2.07-.51-.13-.65l-2.2-1.7zM13 17c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z" />
            </svg>
            Panel Admin
        </a>
    </div>
    {% endif %}
</div>

<div class="overlay"></div>

<script src="{{ url_for('static', filename='js/navbar.js') }}"></script>
