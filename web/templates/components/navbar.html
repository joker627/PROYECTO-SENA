<nav class="navbar">
    <div class="brand">
        <a href="#" class="brand-link">
            <img src="{{ url_for('static', filename='img/brand/logo.webp') }}" alt="Logo de Sign Technology"
                class="logo">
            <div class="brand-text">
                <div class="brand-name">Sign Technology</div>
                <div class="brand-tagline">INNOVACIÓN DIGITAL</div>
            </div>
        </a>
    </div>

    <div class="nav-wrapper">
        <ul class="nav-links">
            <li><a href="{{ url_for('web_bp.inicio') }}">Inicio</a></li>
            <li><a href="#">Nosotros</a></li>
            <li><a href="#">Tutoriales</a></li>
        </ul>

        <div class="nav-actions">
            {% if session.get('usuario') or session.get('user_id') %}
            <div class="user-section">

                <div class="user-dropdown-trigger">
                    <div class="user-avatar">
                        {% set nombre = session.get('username', 'Usuario') %}
                        {% set palabras = nombre.split() %}
                        {% if palabras|length > 1 %}
                        {{ (palabras[0][0] + palabras[-1][0])|upper }}
                        {% else %}
                        {{ (nombre[0] + (nombre[-1] if nombre|length > 1 else ''))|upper }}
                        {% endif %}
                    </div>
                    {% set _display_name = session.get('username', 'Usuario') %}
                    <span class="user-name-nav">{{ _display_name.split()[0] }}</span>
                    <i class="fas fa-chevron-down dropdown-arrow"></i>
                    
                </div>

                <!-- Menú desplegable usuario -->
                <div class="user-dropdown-menu">
                    <div class="dropdown-header">
                        <div class="user-avatar-large">
                            {% set nombre = session.get('username', 'Usuario') %}
                            {% set palabras = nombre.split() %}
                            {% if palabras|length > 1 %}
                            {{ (palabras[0][0] + palabras[-1][0])|upper }}
                            {% else %}
                            {{ (nombre[0] + (nombre[-1] if nombre|length > 1 else ''))|upper }}
                            {% endif %}
                        </div>
                        <div class="user-details">
                            {% set _dropdown_name = session.get('username', 'Usuario') %}
                            <div class="user-name-dropdown">{{ _dropdown_name.split()[0] }}</div>
                            {% set email = session.get('email') or session.get('correo') or session.get('user_email') or session.get('usuario_email') %}
                            {% if email %}
                            <div class="user-email">{{ email }}</div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="dropdown-divider"></div>
                    {% if session.get('rol') == 1 or session.get('rol') == 3 %}
                    <a href="{{ url_for('web_admin.dashboard') }}" class="dropdown-item">
                        <i class="fas fa-cog"></i> Panel Administrador
                    </a>
                    {% elif session.get('rol') == 2 %}
                    <a href="#" class="dropdown-item">
                        <i class="fas fa-tasks"></i> Panel Colaborador
                    </a>
                    {% endif %}
                    <a href="{{ url_for('web_login.logout') }}" class="dropdown-item logout">
                        <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                    </a>
                </div>

            </div>
            {% else %}
            <!-- Sección cuando NO está logueado -->
            <div class="auth-buttons auth-section">
                <a href="{{ url_for('web_bp.login_form') }}" class="admin-btn">Panel Admin</a>
            </div>
            {% endif %}
        </div>

        <button class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </div>
</nav>

<div class="mobile-menu">
    <button class="close-menu" aria-label="Cerrar menú">
        <i class="fas fa-times" aria-hidden="true"></i>
    </button>

    <div class="mobile-header">
        <a href="#" class="mobile-brand-link">
            <img src="{{ url_for('static', filename='img/brand/logo.webp') }}" alt="Logo de Sign Technology"
                class="logo">
            <div class="mobile-brand-text">
                <div class="mobile-brand-name-top">Sign</div>
                <div class="mobile-brand-name-bottom">Technology</div>
                <div class="mobile-brand-tagline">INNOVACIÓN DIGITAL</div>
            </div>
        </a>
    </div>

    <a href="#">
        <i class="fas fa-home" aria-hidden="true"></i>
        Inicio
    </a>
    <a href="#">
        <i class="fas fa-users" aria-hidden="true"></i>
        Nosotros
    </a>
    <a href="#">
        <i class="fas fa-book" aria-hidden="true"></i>
        Tutoriales
    </a>

    {% if session.get('usuario') or session.get('user_id') %}
    <!-- Sección móvil cuando SÍ está logueado -->
    <div class="mobile-user-section">
        <div class="mobile-user-info">
            <div class="mobile-user-avatar">
                {% set nombre = session.get('username', 'Usuario') %}
                {% set palabras = nombre.split() %}
                {% if palabras|length > 1 %}
                {{ (palabras[0][0] + palabras[-1][0])|upper }}
                {% else %}
                {{ (nombre[0] + (nombre[-1] if nombre|length > 1 else ''))|upper }}
                {% endif %}
            </div>
            <div>
                {% set _mobile_name = session.get('username', 'Usuario') %}
                <div class="mobile-user-name">{{ _mobile_name.split()[0] }}</div>
                {% set mobile_email = session.get('email') or session.get('correo') or session.get('user_email') or session.get('usuario_email') %}
                {% if mobile_email %}
                <div class="user-email">{{ mobile_email }}</div>
                {% endif %}
            </div>
        </div>


        <div class="mobile-panel-section">
            {% if session.get('rol') == 1 or session.get('rol') == 3 %}
            <a href="{{ url_for('web_admin.dashboard') }}" class="mobile-panel-link">
                <i class="fas fa-cog"></i> Panel Administrador
            </a>
            {% elif session.get('rol') == 2 %}
            <a href="#" class="mobile-panel-link">
                <i class="fas fa-tasks"></i> Panel Colaborador
            </a>
            {% endif %}
            <a href="{{ url_for('web_login.logout') }}" class="mobile-logout-link">
                <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
            </a>
        </div>
    </div>
    {% else %}
    <!-- Sección móvil cuando NO está logueado -->
    <div class="mobile-auth-section">
        <a href="#" class="mobile-admin-btn">
            <i class="fa-solid fa-user-shield" aria-hidden="true"></i>

            Panel Admin
        </a>
    </div>
    {% endif %}
</div>