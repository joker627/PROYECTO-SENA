{% extends "base/base.html" %}

{% block title %}Contribuciones{% endblock %}

{% block extra_head %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/contribuciones.css') }}">

{% endblock %}

{% block content %}


    {% include "components/slider.html" %}


<main>
</main>

<main>
    <div class="dashboard-container">
        <div class="dashboard-header">
            <div>
                <h1>Contribuciones</h1>
                <div class="muted">Contribuciones enviadas por usuarios (pendientes)</div>
            </div>
            <div class="header-info">
                <div class="user-count">Mostrando {{ contribuciones|length if contribuciones else 0 }}</div>
            </div>
        </div>

        <div class="main-card">
            <div class="card-header">
                <h2>Contribuciones pendientes</h2>
            </div>
            <div class="card-muted">
                {% if contribuciones and contribuciones|length > 0 %}
                <div class="contrib-grid">
                    {% for c in contribuciones %}
                    <article class="contrib-card" id="contrib-{{ c.id_contribucion }}">
                        <div class="contrib-left">
                            <div class="contrib-meta">
                                <div class="contrib-word">{{ c.palabra_asociada }}</div>
                                <div class="contrib-desc">{{ c.descripcion[:160] }}{% if c.descripcion|length > 160 %}...{% endif %}</div>
                                <div class="muted small">Enviado: {{ c.fecha_contribucion }}</div>
                            </div>
                        </div>
                        <div class="contrib-right">
                            <div class="contrib-media">
                                {% if c.archivo_video %}
                                    <a href="{{ c.archivo_video }}" target="_blank" class="btn-link">Ver video</a>
                                {% else %}
                                    <span class="muted small">Sin video</span>
                                {% endif %}
                            </div>
                            <div class="contrib-actions">
                                <form method="POST" action="{{ url_for('web_admin.approve_contribucion', id_contribucion=c.id_contribucion) }}" class="inline-form">
                                    <button type="submit" class="btn-approve" onclick="return confirm('Aprobar contribución #{{ c.id_contribucion }}?')"><i class="fas fa-check"></i>&nbsp;Aprobar</button>
                                </form>
                                <form method="POST" action="{{ url_for('web_admin.delete_contribucion', id_contribucion=c.id_contribucion) }}" class="inline-form">
                                    <button type="submit" class="btn-delete" onclick="return confirm('Eliminar contribución #{{ c.id_contribucion }}? Esta acción no se puede deshacer.')"><i class="fas fa-trash"></i>&nbsp;Eliminar</button>
                                </form>
                            </div>
                        </div>
                    </article>
                    {% endfor %}
                </div>
                {% else %}
                <div class="no-results muted">No hay contribuciones pendientes.</div>
                {% endif %}
            </div>
        </div>
    </div>
</main>
</main>

    {% endblock %}